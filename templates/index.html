<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>CM-Edgetunnel专用文件柜</title>
    <!-- 更新到最新的 Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- 添加 Font Awesome 图标 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <style>
        /* 添加一个调试样式 */
        .debug-marker {
            position: fixed;
            top: 10px;
            left: 10px;
            padding: 5px;
            background: red;
            color: white;
            z-index: 9999;
            font-size: 12px;
            display: none; /* 正式使用时隐藏 */
        }
    </style>
</head>
<body>
    <div class="decoration decoration-1"></div>
    <div class="decoration decoration-2"></div>
    <div class="debug-marker">CSS Loaded</div>
    <div class="container">
        <div class="row justify-content-center min-vh-100 align-items-center">
            <div class="col-md-8 col-lg-6">
                <div class="card border-0 shadow-sm">
                    <div class="card-body p-5">
                        <h1 class="text-center mb-4">
                            <!-- 新的文件柜图标 - 极简设计 -->
                            <svg class="mb-3" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <!-- 主体形状 -->
                                <rect x="4" y="2" width="16" height="20" rx="2" class="cabinet-body" />
                                <!-- 简约抽屉线条 -->
                                <line x1="7" y1="8" x2="17" y2="8" class="drawer-line" />
                                <line x1="7" y1="12" x2="17" y2="12" class="drawer-line" />
                                <line x1="7" y1="16" x2="17" y2="16" class="drawer-line" />
                                <!-- 简约把手 -->
                                <line x1="14" y1="7" x2="15" y2="7" class="handle" />
                                <line x1="14" y1="11" x2="15" y2="11" class="handle" />
                                <line x1="14" y1="15" x2="15" y2="15" class="handle" />
                            </svg>
                            <div class="mt-2">CM-Edgetunnel专用文件柜</div>
                        </h1>
                        
                        <div class="upload-area mb-4" id="dropZone">
                            <form id="uploadForm" action="/upload" method="post" enctype="multipart/form-data">
                                <div class="text-center p-5 border-2 border-dashed rounded-3">
                                    <!-- 新的上传图标设计 - 更简约现代 -->
                                    <svg class="mb-3 upload-icon" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                        <!-- 圆形容器 -->
                                        <circle class="icon-circle" cx="12" cy="12" r="10" />
                                        <!-- 上传箭头 -->
                                        <path class="upload-arrow" d="M12 16V8M8 12l4-4 4 4" />
                                    </svg>
                                    <h5 class="mb-3 upload-text">拖拽文件到这里或点击选择</h5>
                                    <input type="file" name="file" class="form-control d-none" id="fileInput">
                                    <button type="button" class="btn btn-modern px-4" onclick="document.getElementById('fileInput').click()">
                                        <span class="btn-content">
                                            <i class="fas fa-arrow-up-from-bracket me-2"></i>
                                            选择文件
                                        </span>
                                    </button>
                                </div>
                            </form>
                        </div>
                        
                        <div id="uploadProgress" class="progress mb-3 d-none">
                            <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar"></div>
                        </div>
                        
                        <div id="uploadStatus" class="mt-3"></div>
                        
                        <div id="fileInfo" class="text-center text-muted mt-3">
                            <small>仅支持上传单个 CSV 或 TXT 格式文件</small>
                        </div>
                        
                        <!-- 添加文件链接区域 -->
                        <div id="fileUrlSection" class="file-url-section mt-4" style="display: none;">
                            <div class="divider mb-4">
                                <div class="divider-line"></div>
                                <div class="divider-text">文件链接</div>
                                <div class="divider-line"></div>
                            </div>
                            <div class="url-container">
                                <div class="input-group">
                                    <input type="text" class="form-control file-url" readonly>
                                    <button class="btn btn-outline-primary copy-btn" type="button">
                                        <i class="fas fa-copy me-1"></i>复制
                                    </button>
                                </div>
                                <div class="copy-feedback">已复制到剪贴板</div>
                            </div>
                        </div>
                        <!-- 修改 API 对接部分的 HTML -->
                        <div id="apiKeySection" class="api-key-section mt-4">
                            <div class="api-section-title">
                                <i class="fas fa-plug"></i>
                                <span>API 对接</span>
                            </div>
                            <div class="text-center mb-3">
                                <button id="generateApiKey" class="btn btn-modern">
                                    <i class="fas fa-key me-2"></i>生成 API 密钥
                                </button>
                            </div>
                            <div id="apiKeyContainer" style="display: none;">
                                <div class="url-container">
                                    <div class="input-group">
                                        <input type="text" class="form-control api-key" readonly>
                                        <button class="btn copy-btn" type="button">
                                            <i class="fas fa-copy me-1"></i>复制
                                        </button>
                                    </div>
                                    <div class="copy-feedback">已复制到剪贴板</div>
                                </div>
                                <div class="mt-3">
                                    <pre class="code-block">
                                        <div class="code-title">自动传输接入规范</div>
                                        <button class="copy-code-btn" title="复制代码">
                                            <i class="fas fa-copy"></i>
                                        </button>
                                        <code>import requests

def upload_file(file_path, api_key):
    """
    上传文件到文件柜
    :param file_path: 本地文件路径
    :param api_key: API密钥
    """
    url = '{{ request.host_url }}upload'  # 自动使用当前服务器地址
    headers = {'X-API-Key': api_key}
    
    with open(file_path, 'rb') as f:
        files = {'file': f}
        response = requests.post(url, 
                               files=files, 
                               headers=headers)
    
    return response.json()</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap 5 JS 和其他必要的脚本 -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
</body>
</html>
